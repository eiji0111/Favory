<div class="container">
  <div class="row py-5">
    <div class="col-6 text-center">
      <% if @customer.sex == 'man' %>
        <%= attachment_image_tag @customer, :profile_image, size: "160x160", format: "jpeg",
            fallback: "no-image-man.jpg", class: 'customer-image shadow rounded-circle' %>
      <% else %>
        <%= attachment_image_tag @customer, :profile_image, size: "160x160", format: "jpeg",
            fallback: "no-image-woman.jpg", class: 'customer-image shadow rounded-circle' %>
      <% end %>
    </div>
    <div class="col-6">
      <div class="col">
        <h5 class="d-inline-block"><%= @customer.nickname %></h5>
        <% if @customer == current_customer %>
          <%= link_to ' ', edit_customer_path, class: 'ml-1 bi bi-gear fa-lg text-dark' %>
        <% else %>
          <div id="follow_form" class="d-inline-block">
            <% if current_customer.following?(@customer) %>
              <%= render partial: "public/relationships/unfollow", locals: { customer: @customer } %>
            <% else %>
              <%= render partial: "public/relationships/follow", locals: { customer: @customer } %>
            <% end %>
          </div>
        <% end %>
      </div>
      <div class="col pt-2">
        <p class="d-inline-block mb-0">ふぁぼ <strong><%= @customer.following_customer.count %></strong>人</p>&emsp;
        <p class="d-inline-block mb-0">ふぁぼされた <strong id="follow_count"><%= render partial: "follow_count", locals: { customer: @customer } %></strong>人</p>
      </div>
      <% if @customer == current_customer %>
        <div class="col pt-3"><%= link_to '自衛官認証申請', new_army_request_path, class: 'btn btn-outline-success btn-sm rounded-pill' %></div>
      <% else %>
        <div class="col pt-3"><%= link_to 'チャットする', chat_path(@customer), class: 'btn btn-outline-success btn-sm rounded-pill far fa-comments' %></div>
      <% end %>
      <div class="col d-none pt-3 d-sm-block">
        ひとこと<br>
        <%= @customer.one_thing %>
      </div>
    </div>
    <div class="col-11 mx-auto pt-3 d-sm-none">
      ひとこと<br>
      <%= @customer.one_thing %>
    </div>
  </div>
  <nav>
    <div class="nav nav-tabs  nav-justified" id="nav-tab" role="tablist">
      <a class="h6 nav-item nav-link active text-dark" id="nav-profile-tab" data-toggle="tab" href="#nav-profile" role="tab" aria-controls="nav-profile" aria-selected="true">Profile</a>
      <a class="h6 nav-item nav-link text-dark" id="nav-love-tab" data-toggle="tab" href="#nav-love" role="tab" aria-controls="nav-love" aria-selected="false">Love</a>
      <a class="h6 nav-item nav-link text-dark" id="nav-hobby-tab" data-toggle="tab" href="#nav-hobby" role="tab" aria-controls="nav-hobby" aria-selected="false">Hobby</a>
      <a class="h6 nav-item nav-link text-dark" id="nav-community-tab" data-toggle="tab" href="#nav-community" role="tab" aria-controls="nav-community" aria-selected="false">Community</a>
    </div>
  </nav>
  <div class="tab-content pt-4" id="nav-tabContent">
    <div class="tab-pane fade show active" id="nav-profile" role="tabpanel" aria-labelledby="nav-profile-tab">
      <ul>
        <% if current_customer == @customer %>
          <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-info">名　前</span><%= @customer.name %></li>
        <% end %>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-info">年　齢</span><%= @customer.age %>歳</li>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-info">居住地</span><%= @customer.address %></li>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-info">職　業</span><%= @customer.jobs %></li>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-info">年　収</span><%= @customer.annual_income %></li>
      </ul>
    </div>
    <div class="tab-pane fade" id="nav-love" role="tabpanel" aria-labelledby="nav-love-tab">
      <ul>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-danger">結婚歴</span><%= @customer.marriage_history %></li>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-danger">子供の有無</span><%= @customer.children %></li>
        <li></li>
      </ul>
    </div>
    <div class="tab-pane fade" id="nav-hobby" role="tabpanel" aria-labelledby="nav-hobby-tab">
      <ul>
        <li>
          <% if @customer.hobby.blank? %>
            未設定
          <% else %>
            <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-warning">趣　味</span><%= @customer.hobby %></li>
          <% end %>
        </li>
        <li class="mb-3"><span class="text-white px-3 py-1 mr-3 rounded-pill bg-warning">性　格</span><%= @customer.personality %></li>
      </ul>
    </div>
    <div class="tab-pane fade" id="nav-community" role="tabpanel" aria-labelledby="nav-community-tab">
      <% if @communities.blank? %>
        <p>まだコミュニティを作成していません。</p>
      <% end %>
      <div class="d-flex flex-nowrap overflow-auto col-12 px-4">
        <% @communities.each do |community| %>
          <% if community.valid_status == "許可済み" %>
            <div class="col-6 col-md-4 col-lg-3 m-3 p-0 card border border-dark rounded">
              <%= attachment_image_tag(community, :community_image, size: "150x150",
                  fallback: "no-image.png", style: 'object-fit: cover;', class: 'card-img-top') %>
              <div class="card-body">
                <h5 class="card-title">
                  <%= link_to community.name, community_path(community) %>
                </h5>
                <p class="card-text text-nowrap text-truncate"><%= community.introduction %></p>
                <p><%= community.owner_nickname %></p>
                <p class="text-center mb-0">
                  <%= link_to "参加する", community_path(community), class: 'btn btn-primary btn-sm rounded-pill' %>
                </p>
              </div>
            </div>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
</div>
